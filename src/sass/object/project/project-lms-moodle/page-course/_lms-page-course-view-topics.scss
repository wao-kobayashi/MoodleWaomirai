//コース詳細
//memo &をつけるとbodyにつく
#page-course-view-flexsections,
#page-course-view-topics {
  .activityiconcontainer.smaller .activityicon {
    width: 24px !important;
    height: 24px !important;
  }
  .section-collapsemenu {
    display: none;
  }
  img {
    width: 100%;
  }

  .course-detail-banner {
    padding: 25px 20px 30px;
    border-radius: $border-radius-middle;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    .course-detail-banner-left {
      display: flex;
      align-items: flex-start;
    }
    .course-detail-banner-icon {
      width: 40px;
      height: 40px;
      margin: 0 10px 0 3px;
      i {
        font-size: 36px;
        display: block;
        line-height: 1;
      }
    }
    .course-detail-banner-text-title {
      font-size: $lms-font-size-l;
      font-weight: 600;
      margin: 0 0 3px;
    }
    .course-detail-banner-text-read {
      font-size: $lms-font-size-ml;
      font-weight: 600 !important;
    }
    // .course-detail-banner-right a {
    //     padding: 12px 16px;
    //     border-radius: $border-radius-small;
    //     border: 1.5px solid white;
    //     color: white;
    //     font-size: $lms-font-size-ml;
    //     font-weight: bold;
    //     &:hover {
    //         text-decoration: none !important;
    //         opacity: 0.7;
    //     }
    // }
    .course-detail-banner-text-button a {
      margin: 12px 0 0;
      padding: 12px 16px;
      border-radius: $border-radius-middle;
      border: 1.5px solid white;
      color: white;
      font-size: $lms-font-size-ml;
      font-weight: bold;
      display: inline-flex;
      &:hover {
        text-decoration: none !important;
        opacity: 0.7;
      }
      &:focus {
        @include focus-tapblack-none;
      }
    }
    &.infomation {
      // background: $cl-alert;
      background: #f2f7f5;
      color: $cl-waogreen;
      border: 2px solid $cl-waogreen;
      .course-detail-banner-text-title {
        color: $cl-waogreen;
      }
      .course-detail-banner-text-read {
        color: $cl-gray;
      }
      .course-detail-banner-text-button a {
        background: $cl-waogreen;
        color: white;
      }
    }
  }
  .course-section.main {
    border: 2px solid $cl-graylightest;
    border-radius: 10px;
    padding: 0 0px !important;
    margin: 0 auto 40px !important;
    // box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.03);
    /* Item */

    .btn.btn-icon {
      background: white !important;
      margin-right: 0rem !important;
    }
    .mb-3,
    .my-3 {
      margin-bottom: 0rem !important;
    }
    .d-block {
      padding: 0px 25px 30px !important;
      border: none !important;
    }
    .section .activity {
      list-style: none;
      padding: 0.25rem 0 0.5rem;
    }
    > .course-section-header {
      // background: $cl-white;
      padding: 18px 15px !important;
      border-bottom: 2px solid $cl-graylightest;
      background: #f8f8f8;
      h3 {
        font-size: $lms-font-size-xl !important;
      }
    }
    h3 {
      font-size: $lms-font-size-l !important;
      margin: 0 0 0 10px;
    }
    .course-section-header {
      padding: 0px 15px;
    }
    .bulkselect + .d-flex {
      width: 100%;
      display: flex;
      justify-content: space-between;
      flex-direction: row-reverse;
    }
    .course-section {
      border: none !important;
    }
  }
  // ========================================
  // 授業のまとめシート用の処理
  // ========================================
  .subject-page-added {
    .course-content-item-content ul {
      display: grid !important;
      grid-template-columns: 1fr 220px;
      grid-template-rows: repeat(3, 1fr);
      gap: 20px 25px;
      //スマホではgridにしない
      @include responsive-style(768px) {
        display: flex !important;
        flex-direction: column;
      }
      li.activity {
        &:nth-child(2) {
          grid-column-start: 1;
          grid-row-start: 2;
        }
        &:nth-child(3) {
          grid-column-start: 1;
          grid-row-start: 3;
        }
      }
      .subject-page-added-note {
        grid-row: span 3 / span 3;
        grid-column-start: 2;
        grid-row-start: 1;
        border: 1px solid #dee2e6;
      }
    }
    .activity {
      padding: 0 !important;
    }
    .activity-item {
      height: 66px;
      // display: flex;
      @include responsive-style(768px) {
        height: auto !important;
      }
    }

    .activity-grid {
      height: 48px;
      @include responsive-style(768px) {
        height: auto !important;
      }
    }
    .activity-item:not(.activityinline) {
      padding: 8px 1rem !important;
      align-items: center;
      @include responsive-style(768px) {
        padding: 1rem !important;
      }
    }
    .activity-icon.align-self-start {
      align-self: center !important;
    }
    .activity-item .activity-completion {
      align-self: center !important;
    }
    .instancename {
      display: -webkit-box;
      -webkit-line-clamp: 2; /* 最大2行に制限 */
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .d-block {
      padding: 0px 16px 30px !important;
    }
    .mt-3,
    .my-3 {
      margin-top: 30px !important;
    }
    .subject-page-added-note {
      list-style: none;
      background: $cl-graylightest;
      border-radius: 1rem;
      padding: 20px;
      .subject-page-added-note-head {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        margin: 0 auto 12px;
      }
      .subject-page-added-note-head-title {
        font-size: $lms-font-size-ml;
        font-weight: 500;
      }
      .subject-page-added-note-head-icon {
        width: 44px;
        height: 44px;
        background: $cl-white;
        border-radius: $border-radius-full;
        position: relative;
      }
      .subject-page-added-note-content {
        font-size: $lms-font-size-s;
        margin: 0 auto 16px;
      }
      .subject-page-added-note-content-download {
        font-size: 14px; //近場のデザインとルールを合わせるので13pxに変更
        justify-content: center;
        background: $cl-white;
        width: 100%;
        height: 44px;
        display: flex;
        align-items: center;
        gap: 4px;
        border-radius: $border-radius-middle;
        font-weight: bold;
        &:hover {
          text-decoration: none;
        }
        span {
          font-size: $lms-font-size-ml;
          margin: 3px 0 0 0;
          line-height: $lineheight-none;
        }
        .subject-page-added-note-content-download-text {
          line-height: $lineheight-none;
        }
      }
    }
    //まだアップしていない画像に関してはこちらを優先
    .subject-page-added-note.not-published {
      .subject-page-added-note-head-icon:before {
        background-image: url("https://waomirai.com/lp/assets/moodle/icn-worksheet-not-published.svg") !important;
      }
    }
  }
}
#page-course-view-topics {
  .secondary-navigation {
    padding-bottom: 40px !important;
  }
}

// ========================================
// コースカテゴリ別スタイル適用処理
// ========================================
//
// $course-stylesの構造：
// $course-styles: (
//   "economy": (".category-53", ".category-48"),
//   "science": (".category-52", ".category-49"),
//   "philosophy": (".category-51", ".category-47"),
//   "english": (".category-50", ".category-54"),
//   "programming": (".course-999999")
// );
//
// 処理の流れ：
// 1. 外側のループ：各カテゴリ名（economy, science, philosophy, english, programming）を取得
// 2. 内側のループ：各カテゴリに属するCSSセレクタ（.category-XX, .course-999999など）を取得
// 3. 各セレクタ内のdiv要素に対して、統一されたスタイルを適用
//
// 目的：
// - コースのカテゴリごとに異なるセレクタを持つ要素に対して
// - 各カテゴリ固有の色（main-color, pale-color）を適用
// - 将来的にカテゴリ別の色分けやスタイル変更が容易になるよう設計
@each $style-name, $categories in $course-styles {
  @each $category in $categories {
    #{$category} {
      //ダウンロードボタンの色
      .subject-page-added-note-content-download {
        color: map-get(
          map-get($common-course-styles, $style-name),
          "main-color"
        ) !important;
        border: map-get(
            map-get($common-course-styles, $style-name),
            "main-color"
          )
          1px
          solid;
      }
      //アイコンの画像
      .subject-page-added-note-head-icon::before {
        content: "";
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        margin: auto;
        z-index: 99;
        background-image: map-get(
          map-get($common-course-styles, $style-name),
          "img-worksheet"
        ) !important;
        background-repeat: no-repeat;
        background-size: contain;
        width: 28px;
        height: 28px;
        display: inline-block;
      }
      //公開時のスタイル
      .published {
        background-color: map-get(
          map-get($common-course-styles, $style-name),
          "pale-light-color"
        ) !important;
      }
    }
  }
}
